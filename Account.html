<!DOCTYPE html>
<html lang="en">

<head>

  <title>Seasoned Selections</title>

   <meta name="Foods" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" type="text/css" href="CSS/style2.css">

  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@500&display=swap" rel="stylesheet">

</head>


<body>


    <header class = "header">

      <h10>Seasoned Selections </h10>

    </header>


    <nav1>
        <div class="">
            <ul id="nav-mobile" class ="">
                <li><a href="index.html">Home</a></li>
                <li class="logged-in">
                  <a href="#" class="modal-trigger" data-target="modal-account">Account</a>
                </li>
                <li class="logged-in">
                  <a href="#" id="logout">Logout</a>
                </li>
                <li class="logged-out">
                  <a href="#" class="modal-trigger" data-target="modal-login">Login</a>
                </li>
                <li class="logged-out">
                  <a href="#" class="modal-trigger" data-target="modal-signup">Sign up</a>
                </li>
            </ul>
        </div>
    </nav1>



    <div id="modal-signup" class="modal">
      <div class="modal-content">
        <h3>Sign up</h3>
        <form id="signup-form">
            <div class="input-field">
              <input type="email" id="signup-email" required />
                <label for="signup-email">Email address</label>
            </div>
            <div class="input-field">
                <input type="password" id="signup-password" required />
                <label for="signup-password">Password</label>
            </div>
          <button>Sign up</button>
        </form>
      </div>
    </div>


    <div id="modal-login" class="modal">
      <div class="modal-content">
        <h3>Login</h3>
        <form id="login-form">
            <div class="input-field">
                <input type="email" id="login-email" required />
                <label for="login-email">Email address</label>
            </div>
            <div class="input-field">
                <input type="password" id="login-password" required />
                <label for="login-password">Password</label>
            </div>
          <button>Login</button>
        </form>
      </div>
    </div>


    <div id="modal-account" class="modal">
      <div class="modal-content center-align">
        <h3>Account details</h3>
        <div class="account-details"></div>
      </div>
    </div>

    <div class= "container">

        <aside>
            <div class="image_container">
                <img class="Images" src="Images/Food12.jpg">
            </div>
        </aside>

        <aside>
            <div class="image_container">
                <img class="Images" src="Images/Food8.jpg">
            </div>
        </aside>


    </div>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.19.1/firebase-app.js";
        import{ getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/9.19.1/firebase-auth.js';
        import {getFirestore} from 'https://www.gstatic.com/firebasejs/9.19.1/firebase-firestore.js';

        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            apiKey: "AIzaSyB7ZR3yQF8SzBv5jWp47FgO6TweEH7hUh4",
            authDomain: "mywebsitedatabase-2ff3e.firebaseapp.com",
            projectId: "mywebsitedatabase-2ff3e",
            storageBucket: "mywebsitedatabase-2ff3e.appspot.com",
            messagingSenderId: "1000470139412",
            appId: "1:1000470139412:web:af3ee0e35596f81c628d01",
            measurementId: "G-2Y86DCEM5R"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        const db = getFirestore(app);


        const data =  src = "ApiScript.js".querySelector(data);
        console.log(data.title)
        await setDoc(doc(db, "guides", 'title'), save.title)

        const accountDetails = document.querySelector('.account-details');
        onAuthStateChanged(auth, user =>{
            if(user) {
                const html =`
                    <div>Logged in as ${user.email}</div>
                    <div>Last logged in: ${user.metadata.lastSignInTime}</div>
                `;
                accountDetails.innerHTML = html;

                console.log('user logged in: ', user)
            } else {
                accountDetails.innerHTML = 'No user logged in';
                console.log('user logged out')
            }
        })
        const signupForm = document.querySelector('#signup-form')
        signupForm.addEventListener('submit', (e) =>{
            e.preventDefault();

            const email = signupForm['signup-email'].value;
            const password = signupForm['signup-password'].value;

            createUserWithEmailAndPassword(auth, email, password)
                .then((cred) =>{
                    const user = cred.user;

                    const modal = document.querySelector('#modal-signup')
                    M.Modal.getInstance(modal).close();
                    signupForm.reset();

                })

        });

        const logout = document.querySelector('#logout');
        logout.addEventListener('click', (e) =>{
            e.preventDefault();
            signOut(auth).then(() => {

            }).catch((error) => {

            });
        });


        const loginForm = document.querySelector('#login-form');
        loginForm.addEventListener('submit', (e) =>{
            e.preventDefault()

            const email = loginForm['login-email'].value;
            const password = loginForm['login-password'].value;

            signInWithEmailAndPassword(auth, email, password)
                .then((cred) =>{
                    const modal = document.querySelector('#modal-login')
                    M.Modal.getInstance(modal).close();
                    loginForm.reset();
                })
        });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script src="scripts/index.js"></script>
</body>
</html>